# 开源软件选取标准与企业参与开源的策略
随着开源理念不断深入人心，软件开源已经成为大势所趋。如何在众多的开源软件当中选取最适合的开源软件来支撑项目？企业参与开源需要采用什么样的策略？笔者将在接下来的篇幅中针对这些问题进行讨论。
## 1.为什么参与开源社区？

从个人角度来讲，参与开源社区能够和很多技术强人直接对话，时刻保持学习的状态。高质量的代码提交才有可能被社区接受，这就促使程序员在技术上不会得过且过。自己提交的代码被社区接收，有助于提升个人的技术影响力。目前在一些代码托管网站（如github）中是可以查询到某个人的社区贡献，github上的个人首页更像是一张名片，使得很多程序员因此获得了很多公司的认可，从而获得了更高的薪水。

从公司的角度来看，参与开源社区有助于提升公司的行业影响力，目前很多软件招投标都把企业对开源社区的贡献作为标书的加分项。公司通过开源社区来构建差异化核心竞争力，从而为商业利益服务。另外很多开源项目中的标准已经成为了事实上的标准，如果不参与开源标准的讨论，会导致公司产品与标准相脱节，从而影响公司产品的推广。

从项目组的角度看，使用开源软件不仅可以减少使用商业软件的成本，还有助于减少自研软件代码编写的工作量，而参与开源社区贡献有助于引导社区向项目组需要的方向发展。早先我们使用开源软件来支撑公司项目，在使用中发现开源软件虽然能够满足我们大部分的需求，但不能满足所有的需求。接下来我们对开源软件的代码进行了修改，添加了自己需要的功能。然而，当开源社区发布新的版本时，由于我们新添加的功能代码没有合入到社区中，所以不得不在社区新的版本中重新合入这些定制的功能代码。当社区架构变化时，合入定制功能代码的工作量将成倍增加。如果不基于社区新的版本进行定制功能的适配，将无法同时使用社区版本的新功能和定制的功能。随着时间的推移，这些定制的功能的适配工作会成为项目组的负担。项目组意识到如果能将定制的功能代码合入到社区中，将大大减少项目组的工作量。

## 2.选取开源软件的标准
面对众多的开源软件，如果选择适合的开源软件？以下列举了一些标准供读者参考。
### 2.1关注开源协议的法律风险
如果你打算基于开源软件制作一款商业产品再发布的话，需要注意开源协议带来的法律风险。通常推荐使用商业友好型的开源协议（如Apache协议）的开源软件，而谨慎使用非商业友好型的开源协议（如GPL协议）的开源软件。关于开源软件的法律风险，已经远超本文的范畴，如有需要请咨询律师或者查阅文献。
### 2.2软件是否满足业务
这是使用开源软件的必要条件，包括软件的功能、系统架构、稳定性、扩展性、性能、兼容性、安全性是否能够满足业务要求，对于不能满足的方面需要评估对软件进行改造的工作量。
### 2.3contributors、commits、Pull Requests、Issues、Fork数值
数值越高越说明社区被关注的程度越高，社区的活跃程度也越高。
### 2.4社区文档是否完善
完善的文档有利于我们对开源软件环境配置、使用方法、架构原理等方面的理解。
### 2.5开源贡献者的分布情况
开源分布着越广越说明社区越健康。Kernel社区有上百家的单位或组织参与其中，该社区不会因为某个单位或组织的停止参与而对社区的运作造成致命影响。如果某个社区只有一家或者少数几家公司或组织参与，你就需要评估某家单位停止参与社区后社区能否正常运作。
### 2.6市场占用率及认可程度、成熟度
市场占用率意味着开源软件已经受到了广泛的认可，可以优先选择。
### 2.7项目是否加入开源基金会
开源基金会相当于开源软件的联合国，基金会可以避免开源社区被某一家公司完全控制。没有加入开源基金会的项目有可能会被竞争对手收购或控制，这会对自己造成不利的局面。截止作者发稿时，Docker社区还没有加入任何基金会，所以某一公司可以通过收购的方式来完全控制该社区。对Docker社区依赖程度很高的公司需要考虑该风险，可以考虑选择一个社区（如Rkt）作为Docker的备选方案。
### 2.8开源社区接纳新特性的能力
社区接纳新特性的能力越强也有利于引导社区向公司需要的方向发展。
### 2.9对于提出问题或软件缺陷响应的速度
响应速度越快越有利于问题的解决。通常有商业公司支撑的开源社区响应速度要快于由开源爱好者自发建立的社区。
### 2.10是否有成熟的测试用例和验证方案
成熟的测试用例和验证方案有利于保证代码的质量。目前Kernel社区和Docker社区都有对应的验证方案，从而保证了软件代码的质量。
### 2.11社区是否有大公司支持，maintainer、committer、contributor区分是否清晰。
据调查，大部分开源代码贡献者是受雇与公司来投入开源社区的，他们会在上班时间参与社区贡献。有大公司支持的社区更能够保证持续发展，
### 2.12社区的版本
对于开源软件的初期版本，通常存在较多的缺陷，不推荐使用。而对于最新发布的软件版本，通常包含一些未知的软件缺陷，在可靠性、稳定性、安全性等方面往往会有使用风险。如果盲目使用，有可能会成为该软件版本的试错者。笔者推荐使用相对稳定的版本，在这些版本中往往会有已知缺陷列表和解决步骤。而实际情况下的使用策略，由读者根据自身项目的实际情况自行决定。

## 3.容器云产业生态状况
以上讨论了选取开源软件的标准，下面以容器云产业生态为例介绍从上层到底层的生态现状，读者可以根据自己公司的现状制定参与开源生态的策略。

| 分类 | 涉及的企业或社区 | 现状 |
| ---------------------------------------- | ---------------------------------------- | ---------------------------------------- |
| 容器商用公有云平台 | 亚马逊云、docker云、XX云… | 大小企业并存，同质化严重，且竞争激烈，属于群雄逐鹿阶段。在不远的未来，如果企业需要有充足的资金、核心技术和对生态准确的把握，才能在市场中立足。市场将最终形成寡头。|
| 其它外围工具 | 安全、存储、监控等 | 技术门槛相对不高，恰恰是中小企业的机会点。 |
| 编排工具 | mesos、kubernetes、swarm社区 | 有实力的公司在角逐，三种工具各有优势，三分天下的局面。 |
| 容器引擎 | docker、rkt等社区 | 寡头，技术门槛相对不高，但需要完善生态。 |
| 容器OS | rancheros、coreos、vmware photon、snappy ubuntu core、redhat atomic host等OS | 寡头，有实力的公司参与。 |
| OCI标准项目 | runc、image-spec、runtime-spec社区 | 标准制定的战场，主要是大公司博弈的战场。 |
| 底层内核 | kernel社区 | 支撑容器的底层内核特性，技术门槛高，主要是大公司博弈的战场。 |

## 4.参与开源软件贡献时遇到问题的求助方式
我们在使用开源软件和进行开源贡献时如果遇到问题，可以依次尝试一下方法进行求助。
* 通过互联网搜索引擎进行查询。
* 通过专业技术网站或论坛求助。
* 通过社区中issue板块或者发送邮件到社区邮件列表进行提问。
* 当问题得不到解决时将问题提交给更多的maintainer或社区贡献者。
* 通过社区irc会议进行求助。
* 在外部会议上与maintainer或者专业人士进行讨论。
* 与开展开源项目的公司展开商业合作。

## 5.参与开源软件开发的注意事项
在开源项目落地的过程中，我们需要注意以下几点。
* 如果是报bug，需要满足社区提交bug的规范。
* 处理好与maintainer的关系，取得其信任。如果不是原则问题，避免与maintainer进行过分争论。与maintainer有不同意见时不要挑战其权威，需要用委婉的方式解决分歧。
* 避免在社区中泄露公司的项目细节。
* 不要向社区直接提出低级问题，如配置git的方式。没有把握时可以先在公司内部评审，避免低级问题对公司外部形象造成影响。

## 6.企业参与开源社区的策略
企业参与开源社区的目的是构建差异化竞争力，实现商业利益最大化。开源不是情怀，不是为社会做贡献，而是实实在在的竞争手段，是竞争白热化以后最常用的竞争手段。早年间Symbian是主流的手机系统，当Google将Android开源后有利的打击了竞争对手诺基亚，获取了商业上的成功。

开源不是“把代码贡献出去”的一锤子买卖，每行送出去的代码，都是为了收益。没有背后战略的支撑的开源，就不是真正的开源。笔者所在的公司曾多次强调，公司不关注内部有多少maintainer、committer在社区中，不提倡搞社区排名。公司注重的是是否能够通过参与开源社区来构建公司的核心竞争力，从而为获取商业利益服务。

根据社区的重要程度进行分类，每种类型的社区可应用不同的策略。

* 核心社区
  * 参与制定标准，增大社区或基金会话语权，引导社区向有利于公司的方向发展，制定有利于公司的规范标准。
  * 做成基金会项目（如OCI项目），防止社区被竞争对手控制，或被某一公司绑架，如容器引擎项目。
  * 在社区中培养maintainer、committer参与社区贡献，同时基于社区版本加入新的特性构建差异化核心竞争力。
  
* 重要社区
  * 与外部合作参与社区。
  * 深入了解趋势，为商业化做准备。
  
* 非重要社区
  * 如性能测试套，跟踪社区发展即可。
  
* 边缘社区
  * 如一些已经满足需求的成熟开源工具（如Jenkins），已用为主，不投入。


平衡社区影响力与核心竞争力。

## 7.基于开源软件商用开发的版本交付策略
